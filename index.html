diff --git a/index.html b/index.html
index f4a7d4e4a7eb0a5f94f8e1237224b3789e98577e..4f6b3fa210793eb35e0d6f3ed07741f0cc184105 100644
--- a/index.html
+++ b/index.html
@@ -1,307 +1,919 @@
-<!DOCTYPE html>
-<html lang="tr">
-<head>
-    <meta charset="UTF-8">
-    <meta name="viewport" content="width=device-width, initial-scale=1.0">
-    <title>Berra SimÃ¼latÃ¶r V2</title>
-    <style>
-        /* Genel Sayfa DÃ¼zeni */
-        body {
-            background-color: #e5ddd5;
-            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
-            display: flex;
-            justify-content: center;
-            align-items: center;
-            height: 100vh;
-            margin: 0;
-        }
-
-        /* Chat Penceresi */
-        #chat-container {
-            width: 100%;
-            max-width: 450px;
-            height: 90vh;
-            background: #fff;
-            box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);
-            display: flex;
-            flex-direction: column;
-            border-radius: 10px;
-            overflow: hidden;
-        }
-
-        /* Ãœst BaÅŸlÄ±k */
-        #chat-header {
-            background-color: #075E54;
-            color: white;
-            padding: 15px;
-            display: flex;
-            align-items: center;
-            flex-direction: column;
-        }
-        #chat-header h2 {
-            margin: 0;
-            font-size: 1.2rem;
-        }
-        #mood-status {
-            font-size: 0.8rem;
-            opacity: 0.8;
-            margin-top: 5px;
-        }
-
-        /* Mesaj AlanÄ± */
-        #chat-box {
-            flex: 1;
-            background: #e5ddd5; /* WhatsApp arka plan rengi */
-            padding: 20px;
-            overflow-y: auto;
-            display: flex;
-            flex-direction: column;
-            gap: 10px;
-        }
-
-        /* Mesaj BalonlarÄ± */
-        .message {
-            max-width: 75%;
-            padding: 8px 15px;
-            border-radius: 20px;
-            position: relative;
-            font-size: 15px;
-            line-height: 1.4;
-            word-wrap: break-word;
-        }
-        .message.bot {
-            background: #fff;
-            align-self: flex-start;
-            border-bottom-left-radius: 2px;
-        }
-        .message.user {
-            background: #dcf8c6;
-            align-self: flex-end;
-            border-bottom-right-radius: 2px;
-        }
-        .message.system {
-            background-color: #FFCDD2;
-            color: #D32F2F;
-            align-self: center;
-            text-align: center;
-            font-weight: bold;
-            font-size: 0.9rem;
-        }
-
-        /* Alt Input AlanÄ± */
-        #input-area {
-            background: #f0f0f0;
-            padding: 10px;
-            display: flex;
-            align-items: center;
-        }
-        #user-input {
-            flex: 1;
-            padding: 12px 15px;
-            border: none;
-            border-radius: 30px;
-            outline: none;
-            font-size: 16px;
-        }
-        #send-btn {
-            background: #075E54;
-            color: white;
-            border: none;
-            width: 50px;
-            height: 50px;
-            border-radius: 50%;
-            margin-left: 10px;
-            cursor: pointer;
-            font-size: 20px;
-            display: flex;
-            align-items: center;
-            justify-content: center;
-        }
-        #send-btn:hover { background: #128C7E; }
-        #send-btn:disabled { background: #ccc; cursor: default; }
-
-    </style>
-</head>
-<body>
-
-    <div id="chat-container">
-        <div id="chat-header">
-            <h2>Berra SimÃ¼latÃ¶r</h2>
-            <span id="mood-status">BaÄŸlanÄ±yor...</span>
-        </div>
-        
-        <div id="chat-box">
-            </div>
-
-        <div id="input-area">
-            <input type="text" id="user-input" placeholder="Bir mesaj yaz..." autocomplete="off">
-            <button id="send-btn">âž¤</button>
-        </div>
-    </div>
-
-    <script>
-        // --- AYARLAR VE DEÄžÄ°ÅžKENLER ---
-        const moods = ["KISKANÃ‡", "TATLI", "ALAYCI", "SOÄžUK", "Ä°LGÄ°LÄ°"];
-        
-        // Konu listeleri (Hepsini kÃ¼Ã§Ã¼k harf yaptÄ±k ki eÅŸleÅŸme kolay olsun)
-        const sinema_kelimeleri = ["film", "aktÃ¶r", "dizi", "sinema", "televizyon", "izle", "netflix"];
-        const yemek_kelimeleri = ["dÃ¶ner", "piÅŸir", "hamburger", "acÄ±k", "aÃ§Ä±m", "yemek"];
-        const futbol_kelimeleri = ["maÃ§", "futbol", "top", "taraftar", "saha", "stadyum", "gol"];
-
-        const sinemacevap = ["Hangi filme gidelim?", "Ben en son Kurtlar Vadisi izledim."];
-        const yemekcevap = ["Ben yemek yapamam hiÃ§ yaa", "Ben yemek yapmayÄ± Ã¶ÄŸrenmek Ã§ook isterim"];
-        const futbolcevap = ["Futbol ne ya ilkel spor", "Futboldan ve futbolu seven erkekten hiÃ§ hoÅŸlanmam"];
-
-        let mood = moods[Math.floor(Math.random() * moods.length)];
-        let sabir = 100;
-        let isGameActive = true;
-
-        // HTML Elementlerini seÃ§elim
-        const chatBox = document.getElementById('chat-box');
-        const userInput = document.getElementById('user-input');
-        const sendBtn = document.getElementById('send-btn');
-        const moodStatus = document.getElementById('mood-status');
-
-        // BaÅŸlangÄ±Ã§ ayarlarÄ±
-        moodStatus.textContent = "BugÃ¼nkÃ¼ Modu: " + mood;
-        addSystemMessage("--- Berra SimÃ¼latÃ¶r AÃ§Ä±ldÄ±!!! ---");
-        addBotMessage("Selam! Ã‡Ä±kmak istersen 'Ã§Ä±kÄ±ÅŸ' yazabilirsin.");
-
-        // --- FONKSÄ°YONLAR ---
-
-        function addBotMessage(text) {
-            const div = document.createElement('div');
-            div.className = 'message bot';
-            div.textContent = text;
-            chatBox.appendChild(div);
-            scrollToBottom();
-        }
-
-        function addUserMessage(text) {
-            const div = document.createElement('div');
-            div.className = 'message user';
-            div.textContent = text;
-            chatBox.appendChild(div);
-            scrollToBottom();
-        }
-
-        function addSystemMessage(text) {
-            const div = document.createElement('div');
-            div.className = 'message system';
-            div.textContent = text;
-            chatBox.appendChild(div);
-            scrollToBottom();
-        }
-
-        function scrollToBottom() {
-            chatBox.scrollTop = chatBox.scrollHeight;
-        }
-
-        // OYUN MANTIÄžI BURADA
-        function processMessage() {
-            if (!isGameActive) return;
-
-            let text = userInput.value.trim();
-            if (text === "") return;
-
-            // KullanÄ±cÄ± mesajÄ±nÄ± ekrana bas
-            addUserMessage(text);
-            userInput.value = ""; // Inputu temizle
-
-            // TÃ¼rkÃ§e karakter uyumlu kÃ¼Ã§Ã¼k harfe Ã§evir
-            let userLower = text.toLocaleLowerCase('tr-TR');
-
-            if (userLower === "Ã§Ä±kÄ±ÅŸ") {
-                addSystemMessage("Ã‡Ä±kÄ±ÅŸ yapÄ±lÄ±yor...");
-                endGame();
-                return;
-            }
-
-            let response = "";
-
-            // 1. Ã–zel Kelime Kontrolleri
-            if (userLower.includes("gel")) {
-                response = "Gelirim ama sen dediÄŸin iÃ§in deÄŸil";
-                sabir -= 5;
-            }
-            else if (userLower.includes("boydan")) {
-                response = "Siktir git amk delisi";
-                sabir -= 70;
-            }
-            else if (userLower.includes("foto")) {
-                response = "Yok olmaz anam kÄ±zar";
-                sabir -= 10;
-            }
-            // 2. Konu Kontrolleri
-            else if (sinema_kelimeleri.some(kelime => userLower.includes(kelime))) {
-                response = sinemacevap[Math.floor(Math.random() * sinemacevap.length)];
-            }
-            else if (yemek_kelimeleri.some(kelime => userLower.includes(kelime))) {
-                response = yemekcevap[Math.floor(Math.random() * yemekcevap.length)];
-            }
-            else if (futbol_kelimeleri.some(kelime => userLower.includes(kelime))) {
-                response = futbolcevap[Math.floor(Math.random() * futbolcevap.length)];
-            }
-            // 3. Moda GÃ¶re Cevaplar (Eksikler tamamlandÄ±)
-            else {
-                switch(mood) {
-                    case "ALAYCI":
-                        response = "Ne bakÄ±yon yarrak koyumda yaylan";
-                        break;
-                    case "KISKANÃ‡":
-                        response = "Sen beni mi kÄ±skandÄ±rmaya Ã§alÄ±ÅŸÄ±yorsun?? :) ";
-                        break;
-                    case "TATLI":
-                        response = "Ã‡ok konuÅŸma pipini yerim senin, gel buraya";
-                        break;
-                    case "Ä°LGÄ°LÄ°":
-                        response = "Ya yiÄŸit beni bugÃ¼n neden sevmiyorsun :((( ";
-                        break;
-                    case "SOÄžUK":
-                        response = "Hmm. Peki."; // Python kodunda bu eksikti, ekledim.
-                        break;
-                    default:
-                        response = "AnlamadÄ±m?";
-                }
-            }
-
-            // CevabÄ± biraz bekleyerek ver (gerÃ§ekÃ§i olsun)
-            setTimeout(() => {
-                if (isGameActive) {
-                    addBotMessage(response);
-                    checkSabir();
-                }
-            }, 600);
-        }
-
-        function checkSabir() {
-            if (sabir <= 0) {
-                addSystemMessage("BERRANIN SABRI TÃœKENDÄ°!");
-                addSystemMessage("BerranÄ±n gÃ¼ncel sabrÄ±: " + sabir);
-                addSystemMessage("Berra Ebenizi SÄ°KECEK!!!");
-                endGame();
-            }
-        }
-
-        function endGame() {
-            isGameActive = false;
-            userInput.disabled = true;
-            sendBtn.disabled = true;
-            userInput.placeholder = "Sohbet sona erdi.";
-            moodStatus.textContent = "BaÄŸlantÄ± kesildi.";
-        }
-
-        // Enter tuÅŸu ve Buton dinleyicileri
-        sendBtn.addEventListener('click', processMessage);
-        userInput.addEventListener('keypress', function (e) {
-            if (e.key === 'Enter') {
-                processMessage();
-            }
-        });
-        
-        // Sayfa aÃ§Ä±lÄ±nca inputa odaklar
-        userInput.focus();
-
-    </script>
-</body>
-</html>
+<!DOCTYPE html>
+<html lang="tr">
+<head>
+    <meta charset="UTF-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1.0">
+    <title>Berra SimÃ¼latÃ¶r V2</title>
+    <style>
+        :root {
+            color-scheme: light;
+        }
+
+        body {
+            background-color: #e5ddd5;
+            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
+            display: flex;
+            justify-content: center;
+            align-items: center;
+            height: 100vh;
+            margin: 0;
+            transition: background-color 0.6s ease;
+        }
+
+        body.theme-tatli { background-color: #ffe6f1; }
+        body.theme-sinirli { background-color: #f9d2d2; }
+        body.theme-soguk { background-color: #d7ecff; }
+        body.theme-ask { background-color: #ffd9ec; }
+        body.theme-standart { background-color: #e5ddd5; }
+
+        #chat-container {
+            width: 100%;
+            max-width: 480px;
+            height: 90vh;
+            background: #fff;
+            box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);
+            display: flex;
+            flex-direction: column;
+            border-radius: 16px;
+            overflow: hidden;
+        }
+
+        #chat-header {
+            background: linear-gradient(135deg, #075E54, #0b8263);
+            color: white;
+            padding: 16px 18px;
+            display: flex;
+            flex-direction: column;
+            gap: 8px;
+        }
+
+        #chat-header h2 {
+            margin: 0;
+            font-size: 1.25rem;
+        }
+
+        #status-row {
+            display: flex;
+            justify-content: space-between;
+            align-items: center;
+            flex-wrap: wrap;
+            gap: 8px;
+        }
+
+        #mood-status {
+            font-weight: 600;
+            font-size: 0.95rem;
+        }
+
+        #meters {
+            display: flex;
+            gap: 10px;
+            font-size: 0.8rem;
+            opacity: 0.9;
+        }
+
+        #meters span {
+            background: rgba(255,255,255,0.15);
+            padding: 4px 10px;
+            border-radius: 999px;
+        }
+
+        #chat-box {
+            flex: 1;
+            background: #f7f1eb;
+            padding: 20px;
+            overflow-y: auto;
+            display: flex;
+            flex-direction: column;
+            gap: 12px;
+        }
+
+        .message {
+            max-width: 78%;
+            padding: 10px 16px;
+            border-radius: 20px;
+            position: relative;
+            font-size: 15px;
+            line-height: 1.4;
+            word-wrap: break-word;
+        }
+
+        .message.bot {
+            background: #fff;
+            align-self: flex-start;
+            border-bottom-left-radius: 6px;
+        }
+
+        .message.user {
+            background: #dcf8c6;
+            align-self: flex-end;
+            border-bottom-right-radius: 6px;
+        }
+
+        .message.system {
+            background-color: #FFCDD2;
+            color: #D32F2F;
+            align-self: center;
+            text-align: center;
+            font-weight: bold;
+            font-size: 0.9rem;
+        }
+
+        .typing-indicator {
+            display: inline-flex;
+            gap: 4px;
+            align-items: center;
+            font-size: 0.85rem;
+            color: #666;
+            font-style: italic;
+        }
+
+        .typing-indicator span {
+            display: inline-block;
+            width: 6px;
+            height: 6px;
+            border-radius: 50%;
+            background: #999;
+            animation: blink 1s infinite ease-in-out;
+        }
+
+        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
+        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
+
+        @keyframes blink {
+            0%, 80%, 100% { opacity: 0.2; }
+            40% { opacity: 1; }
+        }
+
+        #input-area {
+            background: #f0f0f0;
+            padding: 12px;
+            display: flex;
+            align-items: center;
+            gap: 10px;
+        }
+
+        #user-input {
+            flex: 1;
+            padding: 12px 15px;
+            border: none;
+            border-radius: 30px;
+            outline: none;
+            font-size: 16px;
+        }
+
+        #send-btn {
+            background: #075E54;
+            color: white;
+            border: none;
+            width: 50px;
+            height: 50px;
+            border-radius: 50%;
+            cursor: pointer;
+            font-size: 20px;
+            display: flex;
+            align-items: center;
+            justify-content: center;
+            transition: background 0.2s ease;
+        }
+
+        #send-btn:hover { background: #128C7E; }
+        #send-btn:disabled { background: #ccc; cursor: default; }
+    </style>
+</head>
+<body class="theme-standart">
+
+    <div id="chat-container">
+        <div id="chat-header">
+            <h2>Berra SimÃ¼latÃ¶r</h2>
+            <div id="status-row">
+                <span id="mood-status">BaÄŸlanÄ±yor...</span>
+                <div id="meters">
+                    <span id="patience-status">SabÄ±r: --</span>
+                    <span id="love-status">Sevgi: --</span>
+                    <span id="trip-status">Trip: --</span>
+                </div>
+            </div>
+        </div>
+
+        <div id="chat-box"></div>
+
+        <div id="input-area">
+            <input type="text" id="user-input" placeholder="Bir mesaj yaz..." autocomplete="off">
+            <button id="send-btn">âž¤</button>
+        </div>
+    </div>
+
+    <script>
+        const BASE_MOODS = ["TATLI", "SOÄžUK", "KISKANÃ‡", "Ä°LGÄ°LÄ°", "ALAYCI"];
+        const LOVE_THRESHOLD = 100;
+        const PATIENCE_START = 100;
+        const TRIP_THRESHOLD = 100;
+        const TRIP_DECAY = 8;
+
+        const moodThemes = {
+            "TATLI": { theme: "theme-tatli", emojis: [":)", "ðŸ¥°", "ðŸ˜˜"], headline: "Modu: TATLI" },
+            "SOÄžUK": { theme: "theme-soguk", emojis: [".", "ðŸ‘"], headline: "Modu: SOÄžUK" },
+            "KISKANÃ‡": { theme: "theme-standart", emojis: ["ðŸ˜’", "ðŸ¤¨"], headline: "Modu: KISKANÃ‡" },
+            "Ä°LGÄ°LÄ°": { theme: "theme-standart", emojis: ["ðŸ˜Š"], headline: "Modu: Ä°LGÄ°LÄ°" },
+            "ALAYCI": { theme: "theme-standart", emojis: ["ðŸ˜"], headline: "Modu: ALAYCI" },
+            "SÄ°NÄ°RLÄ°": { theme: "theme-sinirli", emojis: ["ðŸ˜¡", "ðŸ’¢"], headline: "Modu: SÄ°NÄ°RLÄ°" },
+            "AÅžIK": { theme: "theme-ask", emojis: ["ðŸ’•", "ðŸ’—", "ðŸ˜"], headline: "Modu: AÅžIK" }
+        };
+
+        const complimentKeywords = ["Ã¶zledim", "seviyorum", "gÃ¼zel", "tatlÄ±sÄ±n", "aÅŸkÄ±m", "canÄ±m", "kraliÃ§e", "seni istiyorum",
+"harikasÄ±n", "Ã§ok iyisin", "sÃ¼persin", "prenses", "bir tanesin"];
+        const angerKeywords = ["boydan", "foto", "gel", "salak", "aptal", "ÅŸiÅŸko"];
+        const apologyKeywords = ["Ã¶zÃ¼r dilerim", "affet", "kusura bakma", "piÅŸmanÄ±m"];
+        const gossipNames = ["ayÅŸe", "fatma", "mehmet", "ali", "ahmet", "veli", "merve", "can", "ece", "tolga"];
+        const gossipReplies = [
+            "Ay o isim duyunca bile sinirlerim zÄ±plÄ±yor!",
+            "Onun hakkÄ±nda neler duydum neler...",
+            "O Ã§ocuÄŸun sevgilisi var diyorlar, sakÄ±n bulaÅŸma.",
+            "Ay o kÄ±zdan nefret ediyorum resmen!",
+            "HiÃ§ bana yakÄ±ÅŸmÄ±yor o tipler, sen de uzak dur bak.",
+            "GeÃ§en gÃ¼n yine drama Ã§Ä±karmÄ±ÅŸ, anlatayÄ±m da gÃ¼l." ];
+
+        const fortuneReplies = [
+            "BugÃ¼n adÄ±m adÄ±m Ã¼stÃ¼ne gelecek mutluluk var, hazÄ±r ol!",
+            "Kalbini yoran o dÃ¼ÅŸÃ¼nceyi bÄ±rak, yenisi Ã§ok daha gÃ¼zel gelecek.",
+            "Para yolu gÃ¶rÃ¼nÃ¼yor ama cimrilik yaparsan uÃ§ar gider!",
+            "Eski bir dost kapÄ±nÄ± Ã§alacak, biraz trip at ama onu da kÄ±rma.",
+            "Kalbinin sesi seni doÄŸru kiÅŸiye gÃ¶tÃ¼rÃ¼yor, direnme.",
+            "Ã‡ok yakÄ±nda gÃ¼zel bir haber var, telefonunu aÃ§Ä±k tut.",
+            "BugÃ¼n aynaya bak, en bÃ¼yÃ¼k ÅŸansÄ±n zaten sensin.",
+            "Evren senden yana ama sen de biraz Ã§aba gÃ¶ster canÄ±m.",
+            "Ufukta kÃ¼Ã§Ã¼k bir tatil var, bavulunu hazÄ±rla.",
+            "Bir sÄ±rrÄ±nÄ± paylaÅŸacaksÄ±n ve hafifleyeceksin." ];
+
+        const tripResponses = ["hmm", "peki", "ok", "...", "ne diyorsan", "tamam", "olur"];
+
+        let userName = null;
+
+        function normalizeText(text) {
+            if (!text) return "";
+            return text
+                .toLocaleLowerCase('tr-TR')
+                .normalize('NFD')
+                .replace(/[\u0300-\u036f]/g, '')
+                .replace(/Ä±/g, 'i');
+        }
+
+        function includesKeyword(userLower, userNormalized, keyword) {
+            if (!keyword) return false;
+            const keywordLower = keyword.toLocaleLowerCase('tr-TR');
+            if (keywordLower && userLower.includes(keywordLower)) {
+                return true;
+            }
+            const keywordNormalized = normalizeText(keyword);
+            return keywordNormalized && userNormalized.includes(keywordNormalized);
+        }
+
+        function includesAny(userLower, userNormalized, keywords) {
+            return keywords.some(keyword => includesKeyword(userLower, userNormalized, keyword));
+        }
+
+        const moodResponseTemplates = {
+            "ALAYCI": [
+                () => "Sen beni eÄŸlendirmek iÃ§in mi yazÄ±yorsun?",
+                () => `Cidden mi ${userName || 'tatlÄ±m'}?`,
+                () => "GÃ¼nÃ¼n komedisini yine sen yazdÄ±n."
+            ],
+            "KISKANÃ‡": [
+                () => "Yine kimlerle yazÄ±ÅŸÄ±yorsun bakayÄ±m?",
+                () => `Bak ${userName || 'sen'}, kÄ±skanÄ±yorum iÅŸte!`,
+                () => "Telefonunu ver bakayÄ±m kimlerden bildirim geliyor."
+            ],
+            "TATLI": [
+                () => "Ã‡ok konuÅŸma pipini yerim senin, gel buraya",
+                () => `Ya ${userName || 'balÄ±m'}, beni ÅŸÄ±martÄ±yorsun yine.`,
+                () => "Seni bÃ¶yle sevince ben eriyorum."
+            ],
+            "Ä°LGÄ°LÄ°": [
+                () => "Anlat hadi dinliyorum seni.",
+                () => `BugÃ¼n ne oldu da yazdÄ±n bana ${userName || 'canÄ±m'}?`,
+                () => "Detay ver, hikayeyi tamamlayayÄ±m."
+            ],
+            "SOÄžUK": [
+                () => "Hmm. Peki.",
+                () => "Not ettim.",
+                () => "KayÄ±tlara geÃ§sin."
+            ],
+            "SÄ°NÄ°RLÄ°": [
+                () => "Bak sabrÄ±mÄ± zorlama!",
+                () => "Biraz sessiz kal istersen.",
+                () => "Sinirlerim tepemde, dikkat et."
+            ],
+            "AÅžIK": [
+                () => `Sen yazÄ±nca iÃ§im pÄ±r pÄ±r oluyor ${userName || 'tatlÄ±m'}.`,
+                () => "Kalbim emoji gibi Ã§arpÄ±yor ÅŸu an.",
+                () => `Ã‡ok fena baÄŸlandÄ±m sana ${userName || 'balÄ±m'}.`
+            ],
+            "default": [
+                () => "AnlamadÄ±m?",
+                () => "Bir daha aÃ§Ä±kla bakayÄ±m.",
+                () => "Dinliyorum, devam et."
+            ]
+        };
+
+        const genericResponses = [
+            () => "Beni ÅŸaÅŸÄ±rtacak bir ÅŸey sÃ¶yle artÄ±k.",
+            () => `BugÃ¼n de drama mÄ± arÄ±yorsun ${userName || 'tatlÄ±m'}?`,
+            () => "Senden gelecek dedikoduya aÃ§Ä±m."
+        ];
+
+        const complimentReplies = [
+            () => `Ya ${userName || 'tatlÄ±m'}, sen bÃ¶yle sÃ¶yleyince yÃ¼zÃ¼m kÄ±zardÄ±.`,
+            () => "Daha da sÃ¶yle bakayÄ±m, hoÅŸuma gidiyor.",
+            () => `Senin iltifatlarÄ±n kalbime iÅŸliyor ${userName || 'aÅŸkÄ±m'}.`,
+            () => "Not aldÄ±m, sevgi puanÄ±na ekledim."
+        ];
+
+        const angerReplies = [
+            () => `AÄŸzÄ±nÄ± topla ${userName || 'sen'}.`,
+            () => "O kelimeleri bir daha duymayayÄ±m.",
+            () => "Ä°pler ince, koparmaya Ã§alÄ±ÅŸma.",
+            () => `Trip listemde yÄ±ldÄ±zlÄ± yere geÃ§tin ${userName || 'tatlÄ±m'}.`
+        ];
+
+        const questionReplies = [
+            () => `SorularÄ±na cevap vermeden Ã¶nce sen bana Ã§ay yap ${userName || 'tatlÄ±m'}.`,
+            () => "Benim de sana sorularÄ±m var aslÄ±nda...",
+            () => `Neden merak ettin ki ÅŸimdi ${userName || 'meraklÄ±'}?`,
+            () => "Bir dÃ¼ÅŸÃ¼nmem lazÄ±m, hemen dÃ¶nÃ¼yorum sana."
+        ];
+
+        const smartTopicHandlers = [
+            {
+                key: 'what-doing',
+                keywords: ["napÄ±yorsun", "ne yapÄ±yorsun", "ne yapÄ±yon", "ne yapÄ±yom"],
+                responses: [
+                    () => `Åžu an senin saÃ§malÄ±klarÄ±nÄ± analiz ediyorum ${userName || 'tatlÄ±m'}.`,
+                    () => "Bir elimde kahve, diÄŸer elimde telefon... klasik Berra modu.",
+                    () => "Story bakÄ±yordum ama sen yazÄ±nca bÄ±raktÄ±m."
+                ]
+            },
+            {
+                key: 'how-are-you',
+                keywords: ["nasÄ±lsÄ±n", "nasilsin", "naber", "napÄ±yon"],
+                responses: [
+                    () => "Moduma gÃ¶re deÄŸiÅŸir ama sen yazÄ±nca biraz Ä±sÄ±nÄ±yorum.",
+                    () => `Sen sorunca iyiymiÅŸ gibi hissediyorum ${userName || 'canÄ±m'}.`,
+                    () => "Az Ã¶nce trip atacaktÄ±m ama vazgeÃ§tim."
+                ]
+            },
+            {
+                key: 'hungry',
+                keywords: ["acÄ±ktÄ±m", "acÄ±ktim", "karnÄ±m aÃ§", "yemek"],
+                responses: [
+                    () => "MutfaÄŸa git ve bana da bir ÅŸeyler getir.",
+                    () => `AcÄ±ktÄ±ysan sipariÅŸ ver, ben de ekmeÄŸini yerim ${userName || 'canÄ±m'}.`,
+                    () => "Dolapta ne varsa paylaÅŸ, yoksa trip atarÄ±m."
+                ]
+            },
+            {
+                key: 'tired',
+                keywords: ["yorgunum", "yoruldum", "uykum var", "uykusuzum"],
+                responses: [
+                    () => "Uykunu al gel bana sataÅŸ.",
+                    () => `Benimle yazÄ±ÅŸmak kolay deÄŸil ${userName || 'tatlÄ±m'}.`,
+                    () => "Bir kahve yap, uykun aÃ§Ä±lÄ±r."
+                ]
+            },
+            {
+                key: 'lonely',
+                keywords: ["sÄ±kÄ±ldÄ±m", "yalnÄ±zÄ±m", "canÄ±m sÄ±kÄ±ldÄ±"],
+                responses: [
+                    () => "Ben buradayÄ±m, sÄ±kÄ±lmana izin vermem.",
+                    () => "Bir oyun aÃ§alÄ±m mÄ±, taÅŸ kaÄŸÄ±t makas mesela?",
+                    () => `Seni eÄŸlendirmek tam zamanlÄ± iÅŸ ${userName || 'tatlÄ±m'}.`
+                ]
+            },
+            {
+                key: 'thanks',
+                keywords: ["saÄŸol", "teÅŸekkÃ¼r", "tesekkur", "saÄŸ ol"],
+                responses: [
+                    () => "Ä°ltifat mÄ± bu ÅŸimdi? Kabul ediyorum.",
+                    () => "Rica ederim ama bunu alÄ±ÅŸkanlÄ±k yapma.",
+                    () => "Bana borÃ§landÄ±n, unutma."
+                ]
+            },
+            {
+                key: 'plans',
+                keywords: ["plan", "bugÃ¼n ne yap", "ne yapalÄ±m", "gezelim"],
+                responses: [
+                    () => "Seni gezdirecek moraldeyim, dÃ¼zgÃ¼n davranÄ±rsan olur.",
+                    () => "Plan yapmadan Ã¶nce sabÄ±r barÄ±mÄ± doldur.",
+                    () => `Belki Ã¶nce kahve iÃ§eriz ${userName || 'tatlÄ±m'}, sonra bakarÄ±z.`
+                ]
+            }
+        ];
+
+        const lastResponseIndexes = new Map();
+        const memory = {
+            preferences: []
+        };
+
+        const chatBox = document.getElementById('chat-box');
+        const userInput = document.getElementById('user-input');
+        const sendBtn = document.getElementById('send-btn');
+        const moodStatus = document.getElementById('mood-status');
+        const patienceStatus = document.getElementById('patience-status');
+        const loveStatus = document.getElementById('love-status');
+        const tripStatus = document.getElementById('trip-status');
+
+        let baseMood = BASE_MOODS[Math.floor(Math.random() * BASE_MOODS.length)];
+        let currentMood = baseMood;
+        let sabir = PATIENCE_START;
+        let love = 10;
+        let tripMeter = 0;
+        let isTripMode = false;
+        let gameActive = true;
+        let pendingRPS = false;
+        let pendingChoice = null;
+        let typingElement = null;
+        let loveCelebrated = false;
+
+        updateStatus();
+        addSystemMessage("--- Berra SimÃ¼latÃ¶r AÃ§Ä±ldÄ±!!! ---");
+        respondWithDelay("Selam! Ã–nce adÄ±nÄ± sÃ¶yle de trip listeme kaydedeyim.", { delay: 800 });
+
+        function updateStatus() {
+            refreshMood();
+            const moodInfo = moodThemes[currentMood] || moodThemes[baseMood];
+            moodStatus.textContent = moodInfo ? moodInfo.headline : `Modu: ${currentMood}`;
+            patienceStatus.textContent = `SabÄ±r: ${sabir}`;
+            loveStatus.textContent = `Sevgi: ${love}`;
+            tripStatus.textContent = isTripMode ? `Trip: KÄ±rmÄ±zÄ± Alarm (${tripMeter})` : `Trip: ${tripMeter}`;
+            document.body.className = moodInfo ? moodInfo.theme : 'theme-standart';
+        }
+
+        function addBotMessage(text) {
+            const div = document.createElement('div');
+            div.className = 'message bot';
+            div.textContent = text;
+            chatBox.appendChild(div);
+            scrollToBottom();
+        }
+
+        function addUserMessage(text) {
+            const div = document.createElement('div');
+            div.className = 'message user';
+            div.textContent = text;
+            chatBox.appendChild(div);
+            scrollToBottom();
+        }
+
+        function addSystemMessage(text) {
+            const div = document.createElement('div');
+            div.className = 'message system';
+            div.textContent = text;
+            chatBox.appendChild(div);
+            scrollToBottom();
+        }
+
+        function scrollToBottom() {
+            chatBox.scrollTop = chatBox.scrollHeight;
+        }
+
+        function respondWithDelay(text, options = {}) {
+            const delay = options.delay ?? 1500;
+            showTypingIndicator();
+            setTimeout(() => {
+                hideTypingIndicator();
+                const finalText = options.skipEmoji ? text : appendMoodEmoji(text);
+                addBotMessage(finalText);
+                updateStatus();
+                if (typeof options.after === 'function') {
+                    options.after();
+                }
+            }, delay);
+        }
+
+        function pickUniqueResponse(key, options, context = {}) {
+            if (!options || options.length === 0) {
+                return '';
+            }
+            const previous = lastResponseIndexes.get(key);
+            const indices = options.map((_, index) => index);
+            const available = previous === undefined ? indices : indices.filter(index => index !== previous);
+            const chosen = available.length > 0
+                ? available[Math.floor(Math.random() * available.length)]
+                : indices[Math.floor(Math.random() * indices.length)];
+            lastResponseIndexes.set(key, chosen);
+            const candidate = options[chosen];
+            if (typeof candidate === 'function') {
+                return candidate(context);
+            }
+            return candidate;
+        }
+
+        function wrapWithTimeMessage(text) {
+            const timeMessage = getTimeMessage();
+            if (!timeMessage) return text;
+            const lowerText = text.toLocaleLowerCase('tr-TR');
+            if (lowerText.includes(timeMessage.toLocaleLowerCase('tr-TR'))) {
+                return text;
+            }
+            if (Math.random() < 0.6) {
+                return `${timeMessage} ${text}`;
+            }
+            return text;
+        }
+
+        function getSmartTopicResponse(userLower, userNormalized, originalText) {
+            for (const handler of smartTopicHandlers) {
+                if (handler.keywords.some(keyword => includesKeyword(userLower, userNormalized, keyword))) {
+                    return pickUniqueResponse(`topic-${handler.key}`, handler.responses, { originalText });
+                }
+            }
+            return null;
+        }
+
+        function rememberPreference(preference) {
+            if (!preference) return;
+            if (!memory.preferences.includes(preference)) {
+                memory.preferences.push(preference);
+                if (memory.preferences.length > 5) {
+                    memory.preferences.shift();
+                }
+            }
+        }
+
+        function handlePreferenceStatement(userLower, afterFollowUp) {
+            const match = userLower.match(/ben ([^.!?\n]+?) sev(?:iyorum|iyom|iyor)/);
+            if (!match) return false;
+            const preference = match[1].trim();
+            if (!preference) return false;
+            rememberPreference(preference);
+            adjustLove(6);
+            respondWithDelay(wrapWithTimeMessage(`HÄ±mm ${preference} seviyorsun demek, kaydettim.`), {
+                after: afterFollowUp
+            });
+            return true;
+        }
+
+        function showTypingIndicator() {
+            hideTypingIndicator();
+            typingElement = document.createElement('div');
+            typingElement.className = 'message bot';
+            const indicator = document.createElement('div');
+            indicator.className = 'typing-indicator';
+            indicator.innerHTML = '<span></span><span></span><span></span> Berra yazÄ±yor...';
+            typingElement.appendChild(indicator);
+            chatBox.appendChild(typingElement);
+            scrollToBottom();
+        }
+
+        function hideTypingIndicator() {
+            if (typingElement && typingElement.parentNode) {
+                typingElement.parentNode.removeChild(typingElement);
+                typingElement = null;
+            }
+        }
+
+        function appendMoodEmoji(text) {
+            const moodInfo = moodThemes[currentMood];
+            if (!moodInfo || !moodInfo.emojis || moodInfo.emojis.length === 0) return text;
+            const emoji = moodInfo.emojis[Math.floor(Math.random() * moodInfo.emojis.length)];
+            const trimmed = text.trim();
+            if (trimmed.endsWith(emoji)) {
+                return text;
+            }
+            return `${text} ${emoji}`;
+        }
+
+        function refreshMood() {
+            if (love >= LOVE_THRESHOLD) {
+                currentMood = "AÅžIK";
+            } else if (sabir <= 20) {
+                currentMood = "SÄ°NÄ°RLÄ°";
+            } else {
+                currentMood = baseMood;
+            }
+        }
+
+        function adjustPatience(delta) {
+            sabir = Math.max(0, Math.min(120, sabir + delta));
+            if (delta < 0) {
+                increaseTrip(Math.abs(delta) / 2);
+            } else {
+                decreaseTrip(TRIP_DECAY);
+            }
+            updateStatus();
+            if (sabir === 0) {
+                addSystemMessage("BERRANIN SABRI TÃœKENDÄ°!");
+                respondWithDelay("Valla artÄ±k cevap vermiyorum.", { skipEmoji: true });
+                endGame();
+            }
+        }
+
+        function adjustLove(delta) {
+            love = Math.max(0, Math.min(150, love + delta));
+            updateStatus();
+            if (love >= LOVE_THRESHOLD) {
+                if (!loveCelebrated && currentMood === "AÅžIK") {
+                    loveCelebrated = true;
+                    addSystemMessage("â¤ï¸ Sevgi barÄ± taÅŸtÄ±! Yeni mod aÃ§Ä±ldÄ±: AÅžIK â¤ï¸");
+                }
+            } else {
+                loveCelebrated = false;
+            }
+        }
+
+        function increaseTrip(amount) {
+            if (!isTripMode) {
+                tripMeter = Math.min(TRIP_THRESHOLD, Math.round(tripMeter + amount));
+                if (tripMeter >= TRIP_THRESHOLD) {
+                    isTripMode = true;
+                    respondWithDelay("Sana trip atmaya baÅŸlÄ±yorum haberin olsun.", { skipEmoji: false });
+                }
+            }
+            updateStatus();
+        }
+
+        function decreaseTrip(amount) {
+            tripMeter = Math.max(0, Math.round(tripMeter - amount));
+            if (tripMeter === 0) {
+                isTripMode = false;
+            }
+            updateStatus();
+        }
+
+        function resetTrip(withForgiveness) {
+            isTripMode = false;
+            tripMeter = 20;
+            updateStatus();
+            if (withForgiveness) {
+                respondWithDelay(`Neyse ${userName || 'tatlÄ±m'}, bu seferlik affettim seni.`, {});
+            }
+        }
+
+        function endGame() {
+            gameActive = false;
+            userInput.disabled = true;
+            sendBtn.disabled = true;
+            userInput.placeholder = "Sohbet sona erdi.";
+            moodStatus.textContent = "BaÄŸlantÄ± kesildi.";
+        }
+
+        function askOutfitQuestion() {
+            if (pendingChoice) return;
+            pendingChoice = {
+                options: [
+                    { original: "mavi", normalized: normalizeText("mavi") },
+                    { original: "kÄ±rmÄ±zÄ±", normalized: normalizeText("kÄ±rmÄ±zÄ±") }
+                ],
+                onAnswer(choice) {
+                    if (choice === "kÄ±rmÄ±zÄ±") {
+                        adjustLove(15);
+                        respondWithDelay(wrapWithTimeMessage("Bence de! Zevklisin he."), { after: maybeAskChoice });
+                    } else {
+                        respondWithDelay(wrapWithTimeMessage("Mavi ha... Neyse belki de denemeliyim."), { after: maybeAskChoice });
+                    }
+                    pendingChoice = null;
+                }
+            };
+            respondWithDelay(wrapWithTimeMessage("BugÃ¼n mavi elbisemi mi giyeyim yoksa kÄ±rmÄ±zÄ±yÄ± mÄ±? (mavi/kÄ±rmÄ±zÄ± yaz)"));
+        }
+
+        function maybeAskChoice() {
+            if (pendingChoice || !userName) return;
+            if (Math.random() < 0.2) {
+                askOutfitQuestion();
+            }
+        }
+
+        function handleRPS(userLower, userNormalized, afterFollowUp) {
+            const options = [
+                { original: "taÅŸ", normalized: normalizeText("taÅŸ") },
+                { original: "kaÄŸÄ±t", normalized: normalizeText("kaÄŸÄ±t") },
+                { original: "makas", normalized: normalizeText("makas") }
+            ];
+            const userChoice = options.find(opt => userLower.includes(opt.original) || userNormalized.includes(opt.normalized));
+            if (!userChoice) {
+                respondWithDelay(wrapWithTimeMessage("TaÅŸ mÄ± kaÄŸÄ±t mÄ± makas mÄ± yazacaksÄ±n onu bekliyorum."), { after: afterFollowUp });
+                return;
+            }
+            const botChoice = options[Math.floor(Math.random() * options.length)];
+            let result;
+            if (userChoice.original === botChoice.original) {
+                result = `Ben ${botChoice.original} dedim, berabere kaldÄ±k.`;
+            } else if (
+                (userChoice.original === "taÅŸ" && botChoice.original === "makas") ||
+                (userChoice.original === "kaÄŸÄ±t" && botChoice.original === "taÅŸ") ||
+                (userChoice.original === "makas" && botChoice.original === "kaÄŸÄ±t")
+            ) {
+                result = `Ben ${botChoice.original} dedim ve kaybettim, aferin sana!`;
+                adjustLove(10);
+            } else {
+                result = `Ben ${botChoice.original} dedim ve tabii ki kazandÄ±m.`;
+                adjustPatience(5);
+            }
+            pendingRPS = false;
+            respondWithDelay(wrapWithTimeMessage(result), { after: afterFollowUp });
+        }
+
+        function handleFortune(afterFollowUp) {
+            const message = fortuneReplies[Math.floor(Math.random() * fortuneReplies.length)];
+            respondWithDelay(wrapWithTimeMessage(message), { delay: 1200, after: afterFollowUp });
+        }
+
+        function handleGossip(name, afterFollowUp) {
+            const reply = gossipReplies[Math.floor(Math.random() * gossipReplies.length)];
+            respondWithDelay(wrapWithTimeMessage(`${reply} (${capitalize(name)})`), { after: afterFollowUp });
+        }
+
+        function capitalize(text) {
+            if (!text) return text;
+            return text.charAt(0).toLocaleUpperCase('tr-TR') + text.slice(1);
+        }
+
+        function getTimeMessage() {
+            const now = new Date();
+            const hour = now.getHours();
+            if (hour >= 2 && hour < 5) {
+                return "Bu saatte ne iÅŸin var ayakta?";
+            }
+            if (hour >= 5 && hour < 12) {
+                return "GÃ¼naydÄ±n uykucu.";
+            }
+            return null;
+        }
+
+        function buildDefaultResponse(userLower, originalText) {
+            const fragments = [];
+            if (userName && Math.random() < 0.35) {
+                fragments.push(`Ya ${userName}, bugÃ¼n Ã§ok gÄ±cÄ±ksÄ±n.`);
+            }
+            const moodPool = moodResponseTemplates[currentMood] || moodResponseTemplates.default;
+            const moodLine = pickUniqueResponse(`mood-${currentMood}`, moodPool, { originalText });
+            if (moodLine) {
+                fragments.push(moodLine);
+            }
+            if (memory.preferences.length && Math.random() < 0.35) {
+                const remembered = memory.preferences[Math.floor(Math.random() * memory.preferences.length)];
+                fragments.push(`${capitalize(userName || 'sen')} ${remembered} sevdiÄŸini unutmadÄ±m.`);
+            }
+            if (Math.random() < 0.45) {
+                fragments.push(pickUniqueResponse('generic', genericResponses, { originalText }));
+            }
+            if (fragments.length === 0) {
+                fragments.push(pickUniqueResponse('fallback', moodResponseTemplates.default, { originalText }));
+            }
+            return fragments.join(' ');
+        }
+
+        function detectCompliment(userLower, userNormalized) {
+            return complimentKeywords.some(keyword => includesKeyword(userLower, userNormalized, keyword));
+        }
+
+        function detectAnger(userLower, userNormalized) {
+            return angerKeywords.some(keyword => includesKeyword(userLower, userNormalized, keyword));
+        }
+
+        function detectGossip(userLower, userNormalized) {
+            return gossipNames.find(name => includesKeyword(userLower, userNormalized, name));
+        }
+
+        function processMessage() {
+            if (!gameActive) return;
+            const text = userInput.value.trim();
+            if (!text) return;
+
+            addUserMessage(text);
+            userInput.value = "";
+
+            const userLower = text.toLocaleLowerCase('tr-TR');
+            const userNormalized = normalizeText(text);
+            const forceChoice = includesAny(userLower, userNormalized, ["oyun oyna", "sÄ±kÄ±ldÄ±m"]);
+            const afterFollowUp = () => {
+                if (forceChoice) {
+                    askOutfitQuestion();
+                } else {
+                    maybeAskChoice();
+                }
+            };
+
+            if (userLower === "Ã§Ä±kÄ±ÅŸ" || userNormalized === "cikis") {
+                addSystemMessage("Ã‡Ä±kÄ±ÅŸ yapÄ±lÄ±yor...");
+                endGame();
+                return;
+            }
+
+            const isApology = includesAny(userLower, userNormalized, apologyKeywords);
+
+            if (pendingRPS) {
+                handleRPS(userLower, userNormalized, afterFollowUp);
+                return;
+            }
+
+            if (pendingChoice) {
+                const choice = pendingChoice.options.find(opt => userLower.includes(opt.original) || userNormalized.includes(opt.normalized));
+                if (!choice) {
+                    respondWithDelay("Mavi mi kÄ±rmÄ±zÄ± mÄ±, onu yaz tatlÄ±m.", { after: afterFollowUp });
+                } else {
+                    pendingChoice.onAnswer(choice.original);
+                }
+                return;
+            }
+
+            if (!userName) {
+                userName = capitalize(text.split(' ')[0]);
+                respondWithDelay(wrapWithTimeMessage(`Memnun oldum ${userName}. Bana dÃ¼zgÃ¼n davran yoksa trip atarÄ±m.`), { after: afterFollowUp });
+                adjustLove(10);
+                return;
+            }
+
+            if (isTripMode && !isApology) {
+                respondWithDelay(tripResponses[Math.floor(Math.random() * tripResponses.length)], { skipEmoji: true });
+                return;
+            }
+
+            if (isTripMode && isApology) {
+                resetTrip(true);
+                adjustLove(5);
+                adjustPatience(5);
+                return;
+            }
+
+            if (includesAny(userLower, userNormalized, ["taÅŸ kaÄŸÄ±t makas"])) {
+                pendingRPS = true;
+                respondWithDelay("Tamam, Ã¶nce sen sÃ¶yle ne diyorsun (taÅŸ/kaÄŸÄ±t/makas)?", { after: afterFollowUp });
+                return;
+            }
+
+            if (includesAny(userLower, userNormalized, ["falÄ±ma bak", "falÄ±na bak", "fal bak"])) {
+                handleFortune(afterFollowUp);
+                adjustLove(8);
+                return;
+            }
+
+            if (detectCompliment(userLower, userNormalized)) {
+                adjustLove(12);
+                const complimentLine = pickUniqueResponse('compliment', complimentReplies, { originalText: text });
+                respondWithDelay(wrapWithTimeMessage(complimentLine), { after: afterFollowUp });
+                return;
+            }
+
+            if (detectAnger(userLower, userNormalized)) {
+                adjustPatience(-15);
+                if (!gameActive) {
+                    return;
+                }
+                const angerLine = pickUniqueResponse('anger', angerReplies, { originalText: text });
+                respondWithDelay(wrapWithTimeMessage(angerLine), { skipEmoji: true, after: afterFollowUp });
+                return;
+            }
+
+            const gossipName = detectGossip(userLower, userNormalized);
+            if (gossipName) {
+                handleGossip(gossipName, afterFollowUp);
+                adjustPatience(5);
+                adjustLove(5);
+                return;
+            }
+
+            if (handlePreferenceStatement(userLower, afterFollowUp)) {
+                return;
+            }
+
+            const topicReply = getSmartTopicResponse(userLower, userNormalized, text);
+            if (topicReply) {
+                respondWithDelay(wrapWithTimeMessage(topicReply), { after: afterFollowUp });
+                return;
+            }
+
+            if (text.trim().endsWith('?')) {
+                const questionLine = pickUniqueResponse('question', questionReplies, { originalText: text });
+                respondWithDelay(wrapWithTimeMessage(questionLine), { after: afterFollowUp });
+                return;
+            }
+
+            if (includesAny(userLower, userNormalized, ["sevgi"])) {
+                respondWithDelay(wrapWithTimeMessage(`Åžu an sevgi puanÄ±n ${love}. Daha Ã§alÄ±ÅŸman lazÄ±m.`), { after: afterFollowUp });
+                return;
+            }
+
+            if (includesAny(userLower, userNormalized, ["trip"])) {
+                respondWithDelay(wrapWithTimeMessage(`Trip metre ${tripMeter}. Beni daha kÄ±zdÄ±rma.`), { after: afterFollowUp });
+                return;
+            }
+
+            const defaultResponse = buildDefaultResponse(userLower, text);
+            respondWithDelay(wrapWithTimeMessage(defaultResponse), {
+                after: afterFollowUp
+            });
+        }
+
+        sendBtn.addEventListener('click', processMessage);
+        userInput.addEventListener('keypress', function (e) {
+            if (e.key === 'Enter') {
+                processMessage();
+            }
+        });
+
+        userInput.focus();
+    </script>
+</body>
+</html>
